var timePerImage = 6;
var timeFading   = 1;
var images = <%= Dir['public/img/*'].sort.map{|x| x.gsub('public/', '') }.to_json %>;

var timePerImageMs = timePerImage * 1000;
var timeFadingMs   = timeFading * 1000;

$(document).ready(function() {
  var img1 = $('#img1');
  var img2 = $('#img2');
  doAnimationLoop(img1, img2);
  setInterval(function(){ doAnimationLoop(img1, img2); }, timePerImageMs);
});

function doAnimationLoop(img1, img2) {
  var currentImage = images.shift();
  images.push(currentImage);

  if (img1.is(':visible')) {
    // set img2 to the new pic, fade out img1

    img2.css('background-image', "url('" + currentImage + "')");
    img2.show();
    img1.fadeOut(timeFadingMs);
  } else {
    // set img1 to the new pic, fade in img1
    img1.css('background-image', "url('" + currentImage + "')");
    img1.fadeIn(timeFadingMs);
  }

  // img1.attr('src', currentImage);
  // img1.show();
}
